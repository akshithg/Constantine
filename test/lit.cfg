# -*- Python -*-

import os
import lit.formats
import lit.util

config.name = 'constantine'
config.suffixes = ['.c', '.cpp']
config.test_format = lit.formats.ShTest()
#config.environment
config.unsupported = False
config.on_clone = None
config.test_exec_root = os.path.dirname(__file__)
config.test_source_root = os.path.dirname(__file__)
config.excludes = []
config.target_triple = '-vg'

config.available_features = []
config.available_features.append('asserts')
config.available_features.append('crash-recovery')

config.substitutions = [
    ('%verify_const',
        '%s -fsyntax-only -Xclang -verify -Xclang -load -Xclang %s/src/libconstantine/libconstantine.so -Xclang -plugin -Xclang constantine' % (config.clang_bin, config.constantine_obj_root) ),
    ('%verify_variable_changes',
        '%s -fsyntax-only -Xclang -verify -Xclang -load -Xclang %s/src/libdebugvariablechanges/libdebugvariablechanges.so -Xclang -plugin -Xclang constantine' % (config.clang_bin, config.constantine_obj_root) ),
    ('%verify_variable_usages',
        '%s -fsyntax-only -Xclang -verify -Xclang -load -Xclang %s/src/libdebugvariableusages/libdebugvariableusages.so -Xclang -plugin -Xclang constantine' % (config.clang_bin, config.constantine_obj_root) ),
    ('%show_variables',
        '%s -fsyntax-only -Xclang -verify -Xclang -load -Xclang %s/src/libdebugvariabledeclarations/libdebugvariabledeclarations.so -Xclang -plugin -Xclang constantine' % (config.clang_bin, config.constantine_obj_root) ),
    ('%show_functions',
        '%s -fsyntax-only -Xclang -verify -Xclang -load -Xclang %s/src/libdebugfunctiondeclarations/libdebugfunctiondeclarations.so -Xclang -plugin -Xclang constantine' % (config.clang_bin, config.constantine_obj_root) ),
]
